!function(e){var t={};function o(n){if(t[n])return t[n].exports;var c=t[n]={i:n,l:!1,exports:{}};return e[n].call(c.exports,c,c.exports,o),c.l=!0,c.exports}o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var c in e)o.d(n,c,function(t){return e[t]}.bind(null,c));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=1)}([function(e,t,o){},function(e,t,o){"use strict";o.r(t);o(0);const n=[],c={count:0},r=document.querySelector(".canvas"),a=r.getContext("2d");function l(){let e=1,t=1;document.querySelectorAll(".frame-canvas").forEach(t=>{t.setAttribute("number",`${e}`),e+=1}),document.querySelectorAll(".frame-number").forEach(e=>{e.innerHTML=`${t}`,t+=1})}function i(e){const t=e,o=document.querySelector(".bg"),n=t.createPattern(o,"repeat");t.fillStyle=n,t.fillRect(0,0,r.width,r.height),t.beginPath()}function s(){const e=document.querySelector(".active-frame");if(!e)return;const t=e.getContext("2d");e.width=128,e.height=128;const o=a.getImageData(0,0,r.width,r.height);t.putImageData(o,0,0)}const u=document.querySelector(".canvas2").getContext("2d"),d=document.querySelector(".fps-slider"),m=[];let f;const g={value:100},y={value:0};function h(){f=setInterval(()=>{n.forEach(e=>{m.push(setTimeout(()=>{i(u),u.putImageData(e,0,0)},y.value)),y.value+=g.value})},0)}function v(){clearInterval(f);for(let e=0;e<m.length;e+=1)clearTimeout(m[e])}function p(){g.value=Math.floor(1e3/d.value),y.value=0,v(),h()}const S=document.querySelector(".canvas"),q=S.getContext("2d");let L=null;function b(e){this.style.opacity="0.4",L=this,e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/html",this.innerHTML)}function C(e){return e.preventDefault&&e.preventDefault(),e.dataTransfer.dropEffect="move",!1}function E(){this.classList.add("over")}function x(){this.classList.remove("over")}function k(e){if(e.stopPropagation&&e.stopPropagation(),L!==this){const e=L.firstChild.getAttribute("number"),t=L.firstChild.getContext("2d"),o=t.getImageData(0,0,S.width,S.height),c=this.firstChild.getAttribute("number"),r=this.firstChild.getContext("2d"),a=r.getImageData(0,0,S.width,S.height);document.querySelectorAll(".active-frame").forEach(e=>e.classList.remove("active-frame")),this.firstChild.classList.add("active-frame"),t.putImageData(a,0,0),r.putImageData(o,0,0),q.putImageData(o,0,0),n[e-1]=a,n[c-1]=o,l(),p()}return!1}function I(){document.querySelector(".last-frame").classList.remove("last-frame"),document.querySelector(".active-frame").classList.add("last-frame");const e=document.querySelectorAll(".frame-item");this.style.opacity="1",[].forEach.call(e,e=>{e.classList.remove("over")})}const A=document.querySelector(".canvas"),w=A.getContext("2d"),M=document.querySelector(".canvas2").getContext("2d"),P=document.querySelector(".frames-list");function D(){const e=document.createElement("div"),t=document.createElement("canvas"),o=document.createElement("span"),n=document.createElement("img"),r=document.createElement("img");return e.classList.add("frame-item"),e.setAttribute("draggable","true"),t.classList.add("frame-canvas"),t.setAttribute("number",`${c.count+1}`),o.classList.add("frame-number"),n.classList.add("bin"),n.setAttribute("title","Delete frame"),r.classList.add("clone"),r.setAttribute("title","Clone frame"),o.innerHTML=`${c.count+1}`,c.count>0&&(document.querySelector(".active-frame").classList.remove("active-frame"),document.querySelector(".last-frame").classList.remove("last-frame")),t.classList.add("active-frame"),t.classList.add("last-frame"),t.width=128,t.height=128,function(e){e.addEventListener("dragstart",b,!1),e.addEventListener("dragenter",E,!1),e.addEventListener("dragover",C,!1),e.addEventListener("dragleave",x,!1),e.addEventListener("drop",k,!1),e.addEventListener("dragend",I,!1)}.call(e,e),e.appendChild(t),e.appendChild(o),e.appendChild(n),e.appendChild(r),i(t.getContext("2d")),e}function T(){P.appendChild(D()),i(w),i(M)}function $(){if(A.classList.contains("edited"))return void function(){const e=document.querySelector(".active-frame").getAttribute("number"),t=w.getImageData(0,0,A.width,A.height);n[e-1]=t,p(),s()}();n.pop();const e=w.getImageData(0,0,A.width,A.height);n.push(e),p(),s()}const R=document.querySelector(".canvas"),B=R.getContext("2d");function O(e){const t=B.getImageData(e.offsetX/5,e.offsetY/5,1,1).data.slice(0,3),o=[76,76,76],n=[85,85,85],c=function(e){const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null}(document.querySelector(".color-label1").getAttribute("value")),r=B.getImageData(0,0,R.width,R.height),{data:a}=r;for(let e=0;e<a.length;e+=4)(a[e]===o[0]&&a[e+1]===o[1]&&a[e+2]===o[2]||a[e]===n[0]&&a[e+1]===n[1]&&a[e+2]===n[2]||a[e]===t[0]&&a[e+1]===t[1]&&a[e+2]===t[2])&&(a[e]=c.r,a[e+1]=c.g,a[e+2]=c.b);B.putImageData(r,0,0)}const X=document.querySelector(".canvas");X.width=128,X.height=128;const _=document.querySelector(".add"),j=document.querySelector(".frames-list");function F(){X.addEventListener("mouseup",$),j.addEventListener("click",e=>{e.target.classList.contains("frame-canvas")&&function(e){const t=document.querySelector(".active-frame");e.classList.contains("last-frame")?(r.classList.remove("edited"),t&&t.classList.remove("active-frame"),e.classList.add("active-frame")):(r.classList.add("edited"),t&&t.classList.remove("active-frame"),e.classList.add("active-frame"));const o=e.getContext("2d").getImageData(0,0,r.width,r.height);a.putImageData(o,0,0)}(e.target)}),_.addEventListener("click",()=>{p(),s(),function(){n.pop();let e=document.querySelector(".last-frame");if(!e)return;e!==P.lastChild.firstChild&&(e=P.lastChild.firstChild);let t=e.getContext("2d").getImageData(0,0,A.width,A.height);n.push(t),c.count+=1,i(w),t=w.getImageData(0,0,A.width,A.height),n.push(t),A.classList.remove("edited"),p()}(),T()}),document.addEventListener("click",e=>{if(e.target.classList.contains("clone")){!function(e,t){const o=t.getImageData(0,0,A.width,A.height),r=e.firstChild.getContext("2d"),a=P.lastChild,i=n.pop(),s=document.querySelector(".active-frame");r.putImageData(o,0,0),P.removeChild(a),P.appendChild(a),P.appendChild(e),n.push(o),n.push(i),s&&s.classList.remove("active-frame"),e.firstChild.classList.add("active-frame"),document.querySelector(".last-frame").classList.remove("last-frame"),e.firstChild.classList.add("last-frame"),c.count+=1,p(),l()}(e.target.parentNode.cloneNode(!0),e.target.parentNode.firstChild.getContext("2d"))}}),document.addEventListener("click",e=>{if(e.target.classList.contains("bin")){!function(e){const t=e.firstChild.getAttribute("number");n.splice(t-1,1),P.removeChild(e);const o=document.querySelector(".active-frame");if(o&&o.classList.remove("active-frame"),P.childElementCount<2)return frames=[],p(),i(w),void i(M);P.lastChild.firstChild.classList.add("active-frame");const r=P.lastChild.firstChild.getContext("2d").getImageData(0,0,A.width,A.height);w.putImageData(r,0,0),c.count-=1,p(),l(),P.lastChild.firstChild.classList.add("last-frame")}(e.target.parentNode)}}),X.addEventListener("click",()=>{document.querySelector(".bucket").classList.contains("active-tool")&&(B.fillStyle=document.querySelector(".color-label").getAttribute("value"),B.fillRect(0,0,R.width,R.height),$())}),X.addEventListener("click",e=>{document.querySelector(".paint-same").classList.contains("active-tool")&&(O(e),$())})}function Y(e){document.querySelectorAll(".tools-item").forEach(e=>e.classList.remove("active-tool")),document.querySelectorAll(".choose-color").forEach(e=>e.classList.remove("active-tool")),document.querySelectorAll(".color-label").forEach(e=>e.classList.remove("active-tool")),e.target.classList.contains("tools-item")&&e.target.classList.add("active-tool")}const N=document.getElementById("choose-color1"),H=document.querySelector(".color-label1"),W=document.getElementById("choose-color2"),J=document.querySelector(".color-label2"),Z=document.querySelector(".swap-colors"),G=document.querySelector(".canvas"),U=G.getContext("2d");function z(e){const t=e.toString(16);return 1===t.length?`0${t}`:t}function K(e,t){return function(e){return`#${z(e[0])}${z(e[1])}${z(e[2])}`}(U.getImageData(e,t,1,1).data.slice(0,3))}function Q(){N.addEventListener("input",()=>{H.style.backgroundColor=N.value,H.setAttribute("value",`${N.value}`)}),W.addEventListener("input",()=>{J.style.backgroundColor=W.value,J.setAttribute("value",`${W.value}`)}),Z.addEventListener("click",()=>{const e=H.getAttribute("value"),t=J.getAttribute("value");H.setAttribute("value",t),J.setAttribute("value",e),H.style.backgroundColor=t,J.style.backgroundColor=e}),G.addEventListener("click",e=>{document.querySelector(".picker").classList.contains("active-tool")&&function(e){J.setAttribute("value",H.getAttribute("value")),J.style.backgroundColor=H.style.backgroundColor,H.setAttribute("value",e),H.style.backgroundColor=e}(K(e.offsetX/5,e.offsetY/5))})}const V=document.querySelector(".canvas"),ee=V.getContext("2d"),te=document.querySelector(".canvas2"),oe={};let ne,ce,re=null,ae=null,le=null,ie=null,se=null,ue=null;function de(){const e=document.querySelector(".pen").classList.contains("active-tool"),t=document.querySelector(".eraser").classList.contains("active-tool"),o=document.querySelector(".dithering").classList.contains("active-tool"),n=document.querySelector(".color-label1").getAttribute("value"),c=document.querySelector(".color-label2").getAttribute("value");if(e)ee.fillStyle=n;else if(t)!function(){const e=document.querySelector(".bg"),t=ee.createPattern(e,"repeat");ee.fillStyle=t}();else{if(!o)return!1;!function(e,t){const o=document.createElement("canvas");o.width=8,o.height=8;const n=o.getContext("2d");n.fillStyle=e,n.fillRect(0,0,4,4),n.fillRect(4,4,4,4),n.fillStyle=t,n.fillRect(4,0,4,4),n.fillRect(0,4,4,4);const c=ee.createPattern(o,"repeat");ee.fillStyle=c}(n,c)}return!0}function me(e){if(de()){ae=e.pageX-oe.left,ie=e.pageY-oe.top;const t=Math.abs(ae-re),o=Math.abs(ie-le),n=re<ae?1:-1,c=le<ie?1:-1;let r=t-o;for(;se=Math.floor(re/20),ue=Math.floor(le/20),ee.fillRect(4*se,4*ue,4,4),re!==ae||le!==ie;){const e=2*r;e>-o&&(r-=o,re+=n),e<t&&(r+=t,le+=c)}return 1}return!1}function fe(e){const t=Math.trunc(e.offsetX/20)+1,o=Math.trunc(e.offsetY/20)+1;document.querySelector(".coordinates").innerHTML=`x: ${t}<br>y: ${o}`}function ge(e){oe.left=V.getBoundingClientRect().left,oe.top=V.getBoundingClientRect().top,ee.beginPath(),re=e.pageX-oe.left,le=e.pageY-oe.top,ee.moveTo(re,le),V.addEventListener("mousemove",me),V.addEventListener("click",me)}function ye(){V.removeEventListener("mousemove",me)}V.width=128,V.height=128,te.width=128,te.height=128,ee.lineWidth=4;let he,ve,pe=!1;const Se=new Set(["line","circle","rect","rhombus","triangle","semicircle-bottom","semicircle-top"]);function qe(e){return{x:e.clientX-ne.getBoundingClientRect().left,y:e.clientY-ne.getBoundingClientRect().top}}function Le(){ce.putImageData(ve,0,0)}function be(e,t){ce.beginPath();const o={};o.x=Math.floor(e.x/5),o.y=Math.floor(e.y/5),ce.strokeStyle=document.querySelector(".color-label1").getAttribute("value"),"circle"===t&&function(e){const t=Math.sqrt((he.x-e.x)**2+(he.y-e.y)**2);ce.beginPath(),ce.arc(he.x,he.y,t,0,2*Math.PI,!1)}(o),"line"!==t&&"dashed-line"!==t||function(e){ce.beginPath(),ce.moveTo(he.x,he.y),ce.lineTo(e.x,e.y)}(o),"rhombus"===t&&function(e,t,o){const n=[];let c=o;const r=Math.sqrt((he.x-e.x)**2+(he.y-e.y)**2);let a=0;for(a=0;a<t;a+=1)n.push({x:he.x+r*Math.cos(c),y:he.y-r*Math.sin(c)}),c+=2*Math.PI/t;for(ce.beginPath(),ce.moveTo(n[0].x,n[0].y),a=1;a<t;a+=1)ce.lineTo(n[a].x,n[a].y);ce.closePath()}(o,4,Math.PI/2),"rect"===t&&function(e){ce.beginPath(),ce.rect(he.x,he.y,e.x-he.x,e.y-he.y)}(o),"triangle"===t&&function(e){ce.beginPath(),ce.moveTo(he.x,he.y),ce.lineTo(e.x,e.y),ce.lineTo(he.x+e.x,e.y),ce.closePath()}(o),"semicircle-bottom"===t&&function(e){const t=Math.sqrt((he.x-e.x)**2+(he.y-e.y)**2);ce.beginPath(),ce.arc(he.x,he.y,t,0,Math.PI,!1),ce.closePath()}(o),"semicircle-top"===t&&function(e){const t=Math.sqrt((he.x-e.x)**2+(he.y-e.y)**2);ce.beginPath(),ce.arc(he.x,he.y,t,0,Math.PI,!0),ce.closePath()}(o),ce.stroke()}function Ce(e){if(!document.querySelector(".active-tool"))return;const t=document.querySelector(".active-tool").getAttribute("name");Se.has(t)&&(pe=!0,(he=qe(e)).x=Math.floor(he.x/5),he.y=Math.floor(he.y/5),ve=ce.getImageData(0,0,ne.width,ne.height))}function Ee(e){if(!document.querySelector(".active-tool"))return;const t=document.querySelector(".active-tool").getAttribute("name");if(!Se.has(t))return;let o;if(!0===pe){const t=document.querySelector(".active-tool").getAttribute("name");Le(),be(o=qe(e),t)}}function xe(e){if(!document.querySelector(".active-tool"))return;const t=document.querySelector(".active-tool").getAttribute("name");if(!Se.has(t))return;const o=document.querySelector(".active-tool").getAttribute("name");pe=!1,Le(),be(qe(e),o),ce.beginPath()}const ke={A:65,B:66,C:67,D:68,E:69,F:70,J:74,L:76,N:78,O:79,P:80,R:82,S:83,T:84,W:87,X:88,Z:90};function Ie(e){document.querySelectorAll(".tools-item").forEach(e=>e.classList.remove("active-tool")),e.classList.add("active-tool")}const Ae=document.querySelector(".canvas"),we=Ae.getContext("2d");let Me=!1;function Pe(e){const t=e.toString(16);return 1===t.length?`0${t}`:t}function De(e,t,o){const n=Math.trunc(e/20),c=Math.trunc(t/20),r=we.getImageData(e/5,t/5,1,1).data.slice(0,3);if(!r.every(e=>85===e)&&!r.every(e=>76===e)){for(let e=0;e<r.length;e+=1)o?r[e]+=15:r[e]-=15;var a;we.fillStyle=`#${Pe((a=r)[0])}${Pe(a[1])}${Pe(a[2])}`,we.fillRect(4*n,4*c,4,4)}}function Te(){const e=document.querySelector(".lighten").classList.contains("active-tool"),t=document.querySelector(".darken").classList.contains("active-tool");return!(!e&&!t)}const $e=document.querySelector(".fps-slider");const Re=document.querySelector(".canvas2"),Be=document.querySelector(".full-screen-img");const Oe=document.querySelector(".fps-slider"),Xe=new GIFEncoder;function _e(){Xe.setDelay(Math.floor(1e3/Oe.value)),Xe.start();const e=Array.from(document.querySelectorAll(".frame-canvas"));for(let t=0;t<e.length;t+=1){const o=document.createElement("canvas");o.classList.add("temp-canvas"),o.width=320,o.height=320,o.style.imageRendering="pixelated",document.body.appendChild(o);const n=e[t].getContext("2d").getImageData(0,0,128,128),c=o.getContext("2d");c.putImageData(n,0,0),c.scale(2.5,2.5),c.drawImage(o,0,0),Xe.addFrame(c),document.body.removeChild(o)}Xe.finish(),Xe.download("Piskel Clone.gif")}Xe.setRepeat(0),T(),F(),document.querySelector(".tools-list").addEventListener("click",Y),document.querySelector(".tools-list").addEventListener("mouseover",e=>{e.target.classList.contains("tools-item")&&(e.target.firstChild.style.display="block",e.target.addEventListener("mouseleave",()=>{e.target.firstChild.style.display="none"}))}),document.querySelector(".swap-colors").addEventListener("mouseover",()=>{document.querySelector(".swap-colors-popup").style.display="block"}),document.querySelector(".swap-colors").addEventListener("mouseleave",()=>{document.querySelector(".swap-colors-popup").style.display="none"}),Q(),V.addEventListener("mousemove",fe),V.addEventListener("mousedown",ge),V.addEventListener("mouseout",ye),V.addEventListener("mouseup",ye),ne=document.getElementById("canvas"),(ce=ne.getContext("2d")).lineWidth=4,ne.addEventListener("mousedown",Ce,!1),ne.addEventListener("mousemove",Ee,!1),ne.addEventListener("mouseup",xe,!1),document.addEventListener("keyup",e=>{e.keyCode===ke.P&&Ie(document.querySelector(".pen")),e.keyCode===ke.B&&Ie(document.querySelector(".bucket")),e.keyCode===ke.A&&Ie(document.querySelector(".paint-same")),e.keyCode===ke.C&&Ie(document.querySelector(".circle")),e.keyCode===ke.R&&Ie(document.querySelector(".rect")),e.keyCode===ke.E&&Ie(document.querySelector(".eraser")),e.keyCode===ke.L&&Ie(document.querySelector(".line")),e.keyCode===ke.T&&Ie(document.querySelector(".triangle")),e.keyCode===ke.S&&Ie(document.querySelector(".semicircle-top")),e.keyCode===ke.J&&Ie(document.querySelector(".semicircle-bottom")),e.keyCode===ke.O&&Ie(document.querySelector(".rhombus")),e.keyCode===ke.D&&Ie(document.querySelector(".darken")),e.keyCode===ke.N&&Ie(document.querySelector(".lighten")),e.keyCode===ke.Z&&Ie(document.querySelector(".dithering")),e.keyCode===ke.X&&Ie(document.querySelector(".picker")),e.keyCode===ke.W&&document.querySelector(".swap-colors").click(),e.keyCode===ke.F&&document.querySelector(".full-screen-img").click()}),Ae.addEventListener("mousedown",()=>{Te()&&(Me=!0)}),Ae.addEventListener("mouseup",()=>{Te()&&(Me=!1,we.beginPath())}),Ae.addEventListener("mousemove",e=>{const t=document.querySelector(".lighten").classList.contains("active-tool");Te()&&Me&&De(e.offsetX,e.offsetY,t)}),$e.addEventListener("change",()=>{document.querySelector(".fps").innerHTML=`${$e.value} FPS`,g.value=Math.floor(1e3/$e.value),y.value=0,v(),h()}),Be.addEventListener("click",()=>{document.querySelector(".preview").requestFullscreen()}),document.addEventListener("fullscreenchange",()=>{Re.classList.toggle("inFullScreenMode")}),document.querySelector(".download-gif").addEventListener("click",_e),window.onSignIn=function(e){const t=document.querySelector(".user-block"),o=document.querySelector(".user_email"),n=document.querySelector(".user_pic"),c=e.getBasicProfile();t.style.display="flex",o.innerText=c.getEmail().slice(0,25),n.src=c.getImageUrl()},document.querySelector(".signout").addEventListener("click",()=>{gapi.auth2.getAuthInstance().signOut(),document.querySelector(".user-block").style.display="none"})}]);
//# sourceMappingURL=app.bundle.js.map